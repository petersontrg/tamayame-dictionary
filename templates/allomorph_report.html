{% extends "layout.html" %}
{% block content %}

<h2 class="text-xl font-bold mb-4 text-center">Prefix Allomorph Report</h2>

<div class="flex justify-center">
  <table id="allomorph-report" class="table-auto text-sm border border-collapse w-full max-w-3xl">
    <thead class="bg-gray-100 border-b">
      <tr>
        <th class="px-1 py-1 whitespace-nowrap text-left">Form</th>
        <th class="px-1 py-1 whitespace-nowrap text-left">Gloss</th>
        <th class="px-1 py-1 whitespace-nowrap text-left">Davis ID</th>
      </tr>
    </thead>
    <tbody>
      {# Iterate rows as dicts #}
      {% for a in allomorphs %}
      {% set used = a.usage_count|default(0) %}
      <tr class="border-b">

        {# FORM column with link to detail if used #}
        <td class="px-1 py-1 whitespace-nowrap">
          {% set label = format_headword(a.form, a.affix_position) %}
          {% if used > 0 %}
            <a href="{{ url_for('prmp_detail', allomorph_id=a.allomorph_id) }}" class="text-indigo-700 hover:underline">
              {{ label }}
            </a>
          {% else %}
            {{ label }}
          {% endif %}
        </td>

        {# UR Gloss #}
        <td class="px-1 py-1 whitespace-nowrap">{{ a.ur_gloss or '—' }}</td>

        {# Davis ID #}
        <td class="px-1 py-1 whitespace-nowrap">{{ a.davis_id or '—' }}</td>

      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<p class="mt-6 text-right">
  <a href="{{ url_for('home') }}" class="text-sm text-indigo-600 hover:underline">
    ⬅ Return to Dictionary
  </a>
</p>

{% endblock %}