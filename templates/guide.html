{% extends "layout.html" %}
{% block content %}
<div class="prose max-w-none">
  <h1 class="text-2xl font-bold mb-4">How to Use the Tamayame Dictionary</h1>
  <p>This page explains how to browse, search, and contribute to the Tamayame Online Dictionary.</p>

  <h2 class="mt-6 text-xl font-semibold">Homepage Features</h2>
  <ul class="list-disc pl-6">
    <li><strong>Search bar</strong>: Look up headwords, definitions, or morphemes.</li>
    <li><strong>Filters</strong>: Filter by type (root, stem, affix, word), POS, and status.</li>
    <li><strong>Browse by Sound</strong>: Click phonemes grouped by manner of articulation.</li>
    <li><strong>Export</strong>: Download filtered entries as CSV.</li>
    <li><strong>Morpheme Tools</strong>: Access the Morpheme Index, Promotion Report, and Allomorph Report.</li>
  </ul>

  <h2 class="mt-6 text-xl font-semibold">Adding a New Entry</h2>
  <ol class="list-decimal pl-6">
    <li>Go to "Add New Entry".</li>
    <li>Fill out metadata: Headword, Type, Bound Status, POS, Definitions, Notes, etc.</li>
    <li>Enter morphemes: Segment, Gloss, and Position (e.g. prefix, root).</li>
    <li>Optionally add Allomorphs: Surface form, Davis ID, UR Gloss Category.</li>
  </ol>

  <h2 class="mt-6 text-xl font-semibold">Adding Example Sentences</h2>
  <ol class="list-decimal pl-6">
    <li>On an entry detail page, click "Add Example Sentence".</li>
    <li>Enter Tamayame sentence, gloss, and English translation.</li>
    <li>Use spaces for word breaks and hyphens for morpheme segmentation.</li>
  </ol>

  <h2 class="mt-6 text-xl font-semibold">Understanding Entry Pages</h2>
  <ul class="list-disc pl-6">
    <li><strong>Definition</strong>, <strong>POS</strong>, and <strong>Bound Status</strong>.</li>
    <li><strong>Morpheme Breakdown</strong>: Interlinear gloss and table.</li>
    <li><strong>Examples</strong>: Associated usage in context.</li>
    <li><strong>Used In</strong>: Other entries containing this morpheme in their segmentation.</li>
    <li><strong>Allomorphs</strong>: Alternate forms linked by UR Gloss or Davis ID.</li>
  </ul>

  <h2 class="mt-6 text-xl font-semibold">Morpheme Tools</h2>
  <ul class="list-disc pl-6">
    <li><strong>Morpheme Index</strong>: List of all morphemes with usage counts.</li>
    <li><strong>Morpheme Promotion Report</strong>: Promote morphemes to full dictionary entries.</li>
    <li><strong>Allomorph Report</strong>: Inspect surface forms linked to entries and Davis IDs.</li>
  </ul>

  <h2 class="mt-6 text-xl font-semibold">Best Practices</h2>
  <ul class="list-disc pl-6">
    <li>Follow Leipzig Glossing Rules.</li>
    <li>Label bound status if known (bound vs free).</li>
    <li>Promote key roots and affixes for clarity and reuse.</li>
    <li>Use Davis ID where possible for consistency.</li>
  </ul>

  <h2 class="mt-6 text-xl font-semibold">Guide: Modeling TA Suppletion &amp; PRMP Prefixes</h2>

  <h3 class="mt-4 text-lg font-semibold">1. Add the Verb Root</h3>
  <ol class="list-decimal pl-6">
    <li>In your <strong>Add New Entry</strong> form:
      <ul class="list-disc pl-6">
        <li><strong>Headword</strong>: <code>kacha</code></li>
        <li><strong>Type</strong>: <code>root</code></li>
        <li><strong>POS</strong>: <code>V</code></li>
        <li><strong>Gloss</strong>: <code>see</code></li>
        <li><strong>Status</strong>: <code>draft</code> (or <code>verified</code>)</li>
        <li><strong>Bound Status</strong>: <code>bound</code></li>
        <li><strong>Template</strong> (voice_class): <code>ú/á</code></li>
      </ul>
    </li>
    <li>Under <strong>Morpheme Segmentation</strong>, add one row:
      <ul class="list-disc pl-6">
        <li><strong>segment</strong>: <code>kacha</code></li>
        <li><strong>gloss</strong>: <code>see</code></li>
        <li><strong>position</strong>: <code>root</code></li>
      </ul>
    </li>
    <li>Save the entry; note its <code>entry_id</code> (e.g. <code>423</code>).</li>
  </ol>

  <h3 class="mt-4 text-lg font-semibold">2. Add Example Sentences</h3>
  <p>For entry <code>423</code> (“kacha”), use the Add Example form to create these three:</p>
  <table class="table-auto border mt-2 mb-4">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-2 py-1 border">Tamayame</th>
        <th class="px-2 py-1 border">Gloss</th>
        <th class="px-2 py-1 border">English</th>
        <th class="px-2 py-1 border">example_id</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="px-2 py-1 border"><code>rèdya g-ú-kacha</code></td>
        <td class="px-2 py-1 border"><code>rabbit 3.IND.TA.SG-see</code></td>
        <td class="px-2 py-1 border">He saw a rabbit.</td>
        <td class="px-2 py-1 border">11</td>
      </tr>
      <tr>
        <td class="px-2 py-1 border"><code>rèdya g-ûuʼu-kacha</code></td>
        <td class="px-2 py-1 border"><code>rabbit 3.IND.TA.DL-see</code></td>
        <td class="px-2 py-1 border">They (two) saw a rabbit.</td>
        <td class="px-2 py-1 border">12</td>
      </tr>
      <tr>
        <td class="px-2 py-1 border"><code>rèdya g-úwà-kacha</code></td>
        <td class="px-2 py-1 border"><code>rabbit 3.IND.TA.PL-see</code></td>
        <td class="px-2 py-1 border">They (3+) saw a rabbit.</td>
        <td class="px-2 py-1 border">13</td>
      </tr>
    </tbody>
  </table>

  <h3 class="mt-4 text-lg font-semibold">3. Insert the Morphemes (PRMP + TA)</h3>
  <p>Run these SQL INSERTs against your <code>morphemes</code> table:</p>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>-- PRMP prefix + TA allomorphs
INSERT INTO tamayame_dictionary.morphemes
  (entry_id, segment, gloss, position, ordering, category)
VALUES
  (423, 'g',    'Ind.3',    'prefix', 1, 'affix'),
  (423, 'ú',    'TA.sg',    'prefix', 2, 'affix'),
  (423, 'ûuʼu', 'TA.dl',    'prefix', 2, 'affix'),
  (423, 'úwà',  'TA.pl',    'prefix', 2, 'affix');</code></pre>
  <p>Then grab their IDs:</p>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>SELECT morpheme_id, segment
FROM tamayame_dictionary.morphemes
WHERE entry_id = 423
  AND segment IN ('g','ú','ûuʼu','úwà');</code></pre>

  <h3 class="mt-4 text-lg font-semibold">4. Link Examples to Morphemes</h3>
  <h4 class="mt-2 font-semibold">4A. Create the join table</h4>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>CREATE TABLE tamayame_dictionary.example_morphemes (
  example_id   INTEGER NOT NULL
    REFERENCES tamayame_dictionary.examples(example_id)
    ON DELETE CASCADE,
  morpheme_id  INTEGER NOT NULL
    REFERENCES tamayame_dictionary.morphemes(morpheme_id)
    ON DELETE CASCADE,
  ordering     SMALLINT,
  PRIMARY KEY (example_id, morpheme_id, ordering)
);</code></pre>
  <h4 class="mt-2 font-semibold">4B. Populate for examples 11–13</h4>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>INSERT INTO tamayame_dictionary.example_morphemes
  (example_id, morpheme_id, ordering)
VALUES
  (11, 39, 1),
  (11, 40, 2),
  (11, 38, 3),
  (12, 39, 1),
  (12, 41, 2),
  (12, 38, 3),
  (13, 39, 1),
  (13, 42, 2),
  (13, 38, 3);</code></pre>

  <h3 class="mt-4 text-lg font-semibold">5. Link Morphemes to TA Allomorph Definitions</h3>
  <h4 class="mt-2 font-semibold">5A. Create the mapping table</h4>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>CREATE TABLE tamayame_dictionary.morpheme_ta_allomorph (
  morpheme_id   INTEGER NOT NULL
    REFERENCES tamayame_dictionary.morphemes(morpheme_id)
    ON DELETE CASCADE,
  ta_id         INTEGER NOT NULL
    REFERENCES tamayame_dictionary.ta_allomorphs(ta_id)
    ON DELETE CASCADE,
  PRIMARY KEY (morpheme_id, ta_id)
);</code></pre>
  <h4 class="mt-2 font-semibold">5B. Grab the TA IDs for <code>ú/á</code></h4>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>SELECT ta_id, form, number
FROM tamayame_dictionary.ta_allomorphs
WHERE voice_class = 'ú/á'
  AND form IN ('ú','ûuʼu','úwà');</code></pre>
  <p><em>Assume you get <code>ta_id = 4, 27, 50</code>.</em></p>
  <h4 class="mt-2 font-semibold">5C. Populate the mapping</h4>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>INSERT INTO tamayame_dictionary.morpheme_ta_allomorph
  (morpheme_id, ta_id)
VALUES
  (40,  4),
  (41, 27),
  (42, 50);</code></pre>

  <h3 class="mt-4 text-lg font-semibold">6. Assign the Entry’s Voice Class</h3>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>ALTER TABLE tamayame_dictionary.entries
  ADD COLUMN IF NOT EXISTS template TEXT;

UPDATE tamayame_dictionary.entries
SET template = 'ú/á'
WHERE entry_id = 423;</code></pre>

  <h3 class="mt-4 text-lg font-semibold">7. Create a Consolidated View</h3>
  <pre class="bg-gray-100 p-3 rounded text-sm overflow-x-auto"><code>CREATE OR REPLACE VIEW tamayame_dictionary.entry_ta_allomorphs AS
SELECT
  e.entry_id,
  ta.ta_id,
  ta.form,
  ta.number,
  ta.voice_class
FROM tamayame_dictionary.entries          AS e
JOIN tamayame_dictionary.morphemes        AS m  ON m.entry_id = e.entry_id
JOIN tamayame_dictionary.morpheme_ta_allomorph AS mta ON mta.morpheme_id = m.morpheme_id
JOIN tamayame_dictionary.ta_allomorphs    AS ta ON ta.ta_id = mta.ta_id;</code></pre>

  

</div>
{% endblock %}
